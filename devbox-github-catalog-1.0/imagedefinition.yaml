$schema: "1.0"
name: devbox-customization
image: microsoftwindowsdesktop_windows-ent-cpc_win11-24H2-ent-cpc

tasks:
  - name: ~/powershell
    parameters:
      command: |
        # Enable WSL and required features
        dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
        dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
        wsl --set-default-version 2

  - name: ~/powershell
    parameters:
      command: |
        # Post-install configuration for Docker
        $dockerPath = "C:\Program Files\Docker\Docker"
        if (Test-Path $dockerPath) {
            setx PATH "$env:PATH;$dockerPath"
        }

  - name: ~/winget
    parameters:
      package: Docker.DockerDesktop

  - name: ~/winget
    parameters:
      package: Microsoft.VisualStudioCode

  - name: ~/winget
    parameters:
      package: Python.Python.3

  - name: ~/winget
    parameters:
      package: SlackTechnologies.Slack

userTasks:
  - name: ~/powershell
    parameters:
      command: |
        # Install VSCode extensions
        code --install-extension ms-python.python
        code --install-extension ms-vscode-remote.remote-wsl
